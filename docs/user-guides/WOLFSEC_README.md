# Wolf Security (wolfsec)

A consolidated security module for the Wolf Prowler project that brings together all security functionality into a unified, coherent interface.

## ğŸ›¡ï¸ Overview

Wolf Security consolidates security components from across the Wolf Prowler project:

- **Network Security** (from `wolf_net`) - Encryption, authentication, key management for network communications
- **Cryptographic Operations** (from `wolf_den`) - Low-level cryptographic primitives and secure operations
- **Threat Detection** (from `core`) - Security event processing, threat analysis, and response
- **Authentication & Authorization** - User management, roles, permissions, and session handling
- **Key Management** - Cryptographic key lifecycle, rotation, and certificate management
- **Security Monitoring** - SIEM functionality, dashboards, and metrics collection

## ğŸš€ Quick Start

Add wolfsec to your `Cargo.toml`:

```toml
[dependencies]
wolfsec = "0.1.0"
```

Basic usage:

```rust
use anyhow::Result;
use wolfsec::{WolfSecurity, WolfSecurityConfig};

#[tokio::main]
async fn main() -> Result<()> {
    // Create security instance
    let config = WolfSecurityConfig::default();
    let mut wolf_security = WolfSecurity::new(config)?;
    
    // Initialize all components
    wolf_security.initialize().await?;
    
    // Process security events
    let event = SecurityEvent::new(
        SecurityEventType::SuspiciousActivity,
        SecuritySeverity::Medium,
        "Something suspicious happened".to_string(),
    );
    
    wolf_security.process_security_event(event).await?;
    
    Ok(())
}
```

## ğŸ“¦ Features

### Network Security
- âœ… Multiple encryption algorithms (AES-256-GCM, ChaCha20-Poly1305, XChaCha20-Poly1305)
- âœ… Key exchange protocols (X25519, P-256, P-384)
- âœ… Digital signatures (Ed25519, ECDSA, RSA)
- âœ… Security session management
- âœ… Authentication tokens

### Cryptographic Operations
- âœ… Secure random generation
- âœ… Constant-time operations
- âœ… Hash functions (SHA-256, SHA-512, Blake3)
- âœ… HMAC and key derivation
- âœ… Secure memory management

### Threat Detection
- âœ… Real-time event processing
- âœ… Peer trust management
- âœ… Threat classification and response
- âœ… Automated blocking and mitigation
- âœ… Security metrics and analytics

### Authentication & Authorization
- âœ… User management with roles and permissions
- âœ… Session management
- âœ… Password hashing and verification
- âœ… Token-based authentication
- âœ… Role-based access control (RBAC)

### Key Management
- âœ… Cryptographic key generation and storage
- âœ… Key rotation and lifecycle management
- âœ… Certificate management
- âœ… Trust store management
- âœ… Secure key deletion

### Security Monitoring
- âœ… SIEM functionality with rule engine
- âœ… Real-time dashboards
- âœ… Alert management and correlation
- âœ… Metrics collection and time series
- âœ… Health monitoring

## ğŸ—ï¸ Architecture

Wolf Security follows a modular architecture with clear separation of concerns:

```
WolfSecurity (Orchestrator)
â”œâ”€â”€ NetworkSecurityManager
â”œâ”€â”€ WolfCrypto
â”œâ”€â”€ ThreatDetector
â”œâ”€â”€ AuthManager
â”œâ”€â”€ KeyManager
â””â”€â”€ SecurityMonitor
```

Each component can be used independently or as part of the unified system.

## ğŸ”§ Configuration

Wolf Security uses a hierarchical configuration system:

```rust
use wolfsec::{WolfSecurityConfig, SecurityConfig, CryptoConfig};

let config = WolfSecurityConfig {
    network_security: SecurityConfig {
        default_security_level: HIGH_SECURITY,
        max_sessions_per_peer: 10,
        session_cleanup_interval: 3600,
        token_ttl_hours: 24,
    },
    crypto: CryptoConfig {
        default_algorithm: "AES-256-GCM".to_string(),
        key_size: 256,
        secure_erase: true,
        hardware_acceleration: true,
    },
    // ... other component configurations
};
```

## ğŸ“Š Security Events

Wolf Security provides a unified event system for all security-related activities:

```rust
use wolfsec::{SecurityEvent, SecurityEventType, SecuritySeverity};

let event = SecurityEvent::new(
    SecurityEventType::AuthenticationFailure,
    SecuritySeverity::High,
    "Multiple failed login attempts".to_string(),
)
.with_peer("suspicious-peer-123".to_string())
.with_metadata("source_ip".to_string(), "192.168.1.100".to_string())
.with_metadata("attempts".to_string(), "5".to_string());
```

## ğŸš¨ Alert System

The monitoring system includes a comprehensive alert and SIEM functionality:

```rust
use wolfsec::{Alert, AlertSeverity};

// Alerts are automatically generated by rule engine
// Manual alert creation also supported
let alert = Alert::high_security(security_event);
wolf_security.monitor.send_alert(alert).await?;
```

## ğŸ” Cryptographic Operations

```rust
use wolfsec::{WolfCrypto, CryptoConfig};

let crypto = WolfCrypto::new(CryptoConfig::default())?;
crypto.initialize().await?;

// Generate keys
let key = crypto.generate_key("encryption_key", "AES-256-GCM")?;
crypto.store_key(key).await?;

// Encrypt/decrypt
let plaintext = b"Secret message";
let ciphertext = crypto.encrypt("encryption_key", plaintext).await?;
let decrypted = crypto.decrypt("encryption_key", &ciphertext).await?;
```

## ğŸ‘¥ Authentication

```rust
use wolfsec::{AuthManager, AuthConfig};

let auth = AuthManager::new(AuthConfig::default());
auth.initialize().await;

// Create user
let user = auth.create_user(
    "alice",
    "alice@example.com", 
    "secure_password",
    vec!["user".to_string()]
).await?;

// Authenticate
let token = auth.authenticate("alice", "secure_password", None).await?;

// Check permissions
assert!(auth.has_permission(&user.id, "profile.read"));
```

## ğŸ”‘ Key Management

```rust
use wolfsec::{KeyManager, KeyManagementConfig};

let key_manager = KeyManager::new(KeyManagementConfig::default());
key_manager.initialize().await;

// Generate key pair
let (private_key, public_key) = key_manager.generate_asymmetric_keypair(
    "signing_key", 
    "Ed25519"
)?;

// Create certificate
let cert = key_manager.create_self_signed_certificate(
    "Alice", 
    "signing_key_public", 
    365
).await?;
```

## ğŸ“ˆ Monitoring & Metrics

```rust
use wolfsec::{SecurityMonitor, MonitoringConfig};

let monitor = SecurityMonitor::new(MonitoringConfig::default());
monitor.initialize().await;

// Log events
monitor.log_event(security_event).await?;

// Get status
let status = monitor.get_status().await;
println!("Active alerts: {}", status.active_alerts);
println!("Total events: {}", status.total_events);
```

## ğŸ§ª Testing

Run the test suite:

```bash
cargo test
```

Run examples:

```bash
# Basic usage
cargo run --example basic_usage

# Full security demo (requires full-crypto feature)
cargo run --example full_security --features full-crypto

# Threat detection demo
cargo run --example threat_detection

# SIEM monitoring demo
cargo run --example siem_monitoring
```

## ğŸ”§ Features

Wolf Security uses Cargo features to enable/disable components:

- `default` - All standard features enabled
- `crypto` - Cryptographic operations
- `network-security` - Network security functionality
- `threat-detection` - Threat detection and response
- `authentication` - User authentication and authorization
- `key-management` - Key and certificate management
- `monitoring` - Security monitoring and SIEM
- `advanced-crypto` - Advanced cryptographic features (Ed25519, AES-GCM-SIV)
- `full-crypto` - All cryptographic features

## ğŸ“š Examples

See the `examples/` directory for comprehensive usage examples:

- `basic_usage.rs` - Simple getting started example
- `full_security.rs` - Complete security system demonstration
- `threat_detection.rs` - Threat detection and response
- `siem_monitoring.rs` - Security monitoring and alerting

## ğŸ›¡ï¸ Security Considerations

- **Secure Defaults**: All configurations prioritize security over performance
- **Zero-Knowledge Architecture**: Keys are encrypted at rest and never logged
- **Constant-Time Operations**: All comparisons use timing-safe methods
- **Secure Memory**: Sensitive data is zeroized when dropped
- **Audit Logging**: All security events are logged with full context

## ğŸ¤ Contributing

Wolf Security is part of the Wolf Prowler project. See the main project for contribution guidelines.

## ğŸ“„ License

This project is licensed under either of:

- Apache License, Version 2.0 ([LICENSE-APACHE](LICENSE-APACHE))
- MIT license ([LICENSE-MIT](LICENSE-MIT))

at your option.

## ğŸ”— Related Projects

- [Wolf Prowler](https://github.com/wolfprowler/wolfprowler) - Main project
- [Wolf Net](https://github.com/wolfprowler/wolf-net) - Networking library
- [Wolf Den](https://github.com/wolfprowler/wolf-den) - Cryptographic library
