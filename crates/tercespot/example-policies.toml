# Example Four-Eyes Vault Policies for TersecPot
# This file demonstrates the policy configuration format

[[policies]]
name = "admin_restart_services"
roles = ["admin"]
operations = ["restart", "stop", "start"]
resources = ["apache2", "nginx", "postgresql", "systemd"]
threshold = 2
time_windows = { start_hour = 8, end_hour = 18, days = ["monday", "tuesday", "wednesday", "thursday", "friday"] }
conditions = []

[[policies]]
name = "operator_backup"
roles = ["operator", "admin"]
operations = ["backup", "restore"]
resources = ["database", "files"]
threshold = 1
conditions = [{ MaxFrequency = 4 }]  # Max 4 operations per hour

[[policies]]
name = "auditor_readonly"
roles = ["auditor"]
operations = ["status", "list", "monitor"]
resources = ["logs", "metrics", "system"]
threshold = 1
conditions = []

# Role mappings: Public key hex -> roles
[role_mappings]
"0123456789abcdef..." = ["admin"]  # Example key hex
"fedcba9876543210..." = ["operator", "auditor"]  # Example key hex