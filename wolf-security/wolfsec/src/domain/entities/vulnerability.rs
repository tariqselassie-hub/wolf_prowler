use chrono::{DateTime, Utc};
use serde::{Deserialize, Serialize};
use uuid::Uuid;

/// Standardized severity levels for discovered security vulnerabilities.
#[derive(Debug, Clone, Serialize, Deserialize, PartialEq, Eq, PartialOrd, Ord, Hash)]
pub enum VulnerabilitySeverity {
    /// Non-security informational finding.
    Info,
    /// Marginal risk, often requiring specific conditions to exploit.
    Low,
    /// Moderate risk, should be scheduled for remediation.
    Medium,
    /// High-impact risk that should be addressed as a priority.
    High,
    /// Severe risk providing immediate, broad system access.
    Critical,
}

/// Represents a specific weakness or flaw that could be exploited by a threat.
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct Vulnerability {
    /// Unique internal identifier for the vulnerability record.
    pub id: Uuid,
    /// Standardized Common Vulnerabilities and Exposures (CVE) identifier.
    pub cve_id: Option<String>,
    /// Comprehensive description of the flaw and its potential impact.
    pub description: String,
    /// Static or dynamic severity score assigned to the flaw.
    pub severity: VulnerabilitySeverity,
    /// Identifier of the software component or system host affected.
    pub affected_asset: String,
    /// Point in time when the weakness was identified.
    pub detected_at: DateTime<Utc>,
}
