<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wolf Prowler Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }
        
        .metric-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(71, 85, 105, 0.2);
            transition: all 0.3s ease;
        }
        
        .metric-card:hover {
            border-color: rgba(139, 92, 246, 0.3);
            transform: translateY(-2px);
        }
        
        .status-online {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .status-offline {
            animation: none;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chart-container {
            background: rgba(17, 24, 39, 0.8);
            border-radius: 12px;
            padding: 1.5rem;
        }
        
        .notification-toast {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body class="text-gray-100">
    <div class="min-h-screen flex">
        <!-- Sidebar -->
        <div class="w-64 bg-gray-900/80 backdrop-blur-sm border-r border-gray-700 flex flex-col">
            <div class="p-4 border-b border-gray-700">
                <h1 class="text-xl font-bold flex items-center space-x-2">
                    <i data-lucide="shield" class="w-6 h-6 text-purple-400"></i>
                    <span>Wolf Prowler</span>
                </h1>
            </div>
            
            <nav class="flex-1 p-4 space-y-2">
                <a href="#" onclick="showSection('overview')" class="nav-link flex items-center space-x-3 p-2 rounded-lg bg-purple-600/20 text-purple-300 hover:bg-purple-600/30 transition" data-section="overview">
                    <i data-lucide="home" class="w-5 h-5"></i>
                    <span>Overview</span>
                </a>
                <a href="#" onclick="showSection('security')" class="nav-link flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-700/50 transition" data-section="security">
                    <i data-lucide="shield-alert" class="w-5 h-5"></i>
                    <span>Security</span>
                </a>
                <a href="#" onclick="showSection('network')" class="nav-link flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-700/50 transition" data-section="network">
                    <i data-lucide="network" class="w-5 h-5"></i>
                    <span>Network</span>
                </a>
                <a href="#" onclick="showSection('system')" class="nav-link flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-700/50 transition" data-section="system">
                    <i data-lucide="cpu" class="w-5 h-5"></i>
                    <span>System</span>
                </a>
                <a href="#" onclick="showSection('intelligence')" class="nav-link flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-700/50 transition" data-section="intelligence">
                    <i data-lucide="brain" class="w-5 h-5"></i>
                    <span>Intelligence</span>
                </a>
                <a href="#" onclick="showSection('compliance')" class="nav-link flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-700/50 transition" data-section="compliance">
                    <i data-lucide="file-check" class="w-5 h-5"></i>
                    <span>Compliance</span>
                </a>
                <a href="#" onclick="showSection('administration')" class="nav-link flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-700/50 transition" data-section="administration">
                    <i data-lucide="users" class="w-5 h-5"></i>
                    <span>Administration</span>
                </a>
                <a href="#" onclick="showSection('settings')" class="nav-link flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-700/50 transition" data-section="settings">
                    <i data-lucide="settings" class="w-5 h-5"></i>
                    <span>Settings</span>
                </a>
            </nav>
            
            <div class="p-4 border-t border-gray-700">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center">
                        <i data-lucide="user" class="w-4 h-4 text-white"></i>
                    </div>
                    <div>
                        <p class="text-sm font-medium">Admin</p>
                        <p class="text-xs text-gray-400">Online</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="flex-1 flex flex-col">
            <!-- Header -->
            <header class="bg-gray-900/80 backdrop-blur-sm border-b border-gray-700 p-4 flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <h2 id="pageTitle" class="text-xl font-semibold">Dashboard Overview</h2>
                    <div class="flex items-center space-x-2">
                        <div id="statusDot" class="w-3 h-3 bg-green-500 rounded-full status-online"></div>
                        <span id="statusText" class="text-sm text-gray-300">Real-time</span>
                    </div>
                </div>

                <div class="flex items-center space-x-3">
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Search..." class="bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-1 text-sm focus:outline-none focus:border-purple-500">
                        <i data-lucide="search" class="w-4 h-4 absolute right-2 top-1.5 text-gray-400"></i>
                    </div>
                    <button id="refreshBtn" class="p-2 hover:bg-gray-700/50 rounded-lg transition">
                        <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                    </button>
                    <button id="exportBtn" class="p-2 hover:bg-gray-700/50 rounded-lg transition">
                        <i data-lucide="download" class="w-5 h-5"></i>
                    </button>
                    <button class="p-2 hover:bg-gray-700/50 rounded-lg transition">
                        <i data-lucide="bell" class="w-5 h-5"></i>
                    </button>
                    <button class="p-2 hover:bg-gray-700/50 rounded-lg transition">
                        <i data-lucide="moon" class="w-5 h-5"></i>
                    </button>
                </div>
            </header>
            
            <!-- Dashboard Content -->
            <main class="flex-1 p-6 overflow-auto">
                <!-- Overview Section -->
                <div id="overview-section" class="dashboard-section">
                    <!-- Metrics Row -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">CPU Usage</h3>
                                <i data-lucide="cpu" class="w-5 h-5 text-purple-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-purple-400" id="cpuUsage">--%</div>
                            <div class="w-full bg-gray-700 rounded-full h-2 mt-3">
                                <div class="bg-purple-500 h-2 rounded-full" style="width: 0%" id="cpuBar"></div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Memory Usage</h3>
                                <i data-lucide="memory-stick" class="w-5 h-5 text-blue-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-blue-400" id="memoryUsage">-- MB</div>
                            <div class="w-full bg-gray-700 rounded-full h-2 mt-3">
                                <div class="bg-blue-500 h-2 rounded-full" style="width: 0%" id="memoryBar"></div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Active Peers</h3>
                                <i data-lucide="users" class="w-5 h-5 text-green-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-green-400" id="activePeers">--</div>
                            <div class="text-sm text-gray-400 mt-2">Network Health: <span id="networkHealth">--</span>%</div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Security Score</h3>
                                <i data-lucide="shield-check" class="w-5 h-5 text-orange-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-orange-400" id="securityScore">--</div>
                            <div class="text-sm text-gray-400 mt-2">Threats: <span id="activeThreats">--</span></div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                                <i data-lucide="activity" class="w-5 h-5 text-purple-400"></i>
                                <span>System Performance</span>
                            </h3>
                            <canvas id="performanceChart"></canvas>
                        </div>

                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                                <i data-lucide="network" class="w-5 h-5 text-blue-400"></i>
                                <span>Network Activity</span>
                            </h3>
                            <canvas id="networkChart"></canvas>
                        </div>
                    </div>

                    <!-- Activity Feed & Security -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                                <i data-lucide="list" class="w-5 h-5 text-green-400"></i>
                                <span>Activity Feed</span>
                            </h3>
                            <div class="space-y-3 max-h-80 overflow-y-auto" id="activityFeed">
                                <div class="flex items-start space-x-3 p-2 hover:bg-gray-800/30 rounded">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                                    <div class="flex-1">
                                        <p class="text-sm">System initialized</p>
                                        <p class="text-xs text-gray-500">Just now</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                                <i data-lucide="shield-alert" class="w-5 h-5 text-orange-400"></i>
                                <span>Security Alerts</span>
                            </h3>
                            <div class="space-y-3 max-h-80 overflow-y-auto" id="securityAlerts">
                                <div class="flex items-start space-x-3 p-2 hover:bg-gray-800/30 rounded">
                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                    <div class="flex-1">
                                        <p class="text-sm">No security alerts</p>
                                        <p class="text-xs text-gray-500">System secure</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Security Section -->
                <div id="security-section" class="dashboard-section hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold mb-4">Security Operations Center</h3>
                        <p class="text-gray-400">Comprehensive threat detection, behavioral analysis, and incident response</p>
                    </div>

                    <!-- Security Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Active Threats</h3>
                                <i data-lucide="alert-triangle" class="w-5 h-5 text-red-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-red-400" id="activeThreatsCount">--</div>
                            <div class="text-sm text-gray-400 mt-2">Last 24h: <span id="threats24h">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Behavioral Score</h3>
                                <i data-lucide="brain" class="w-5 h-5 text-blue-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-blue-400" id="behavioralScore">--</div>
                            <div class="text-sm text-gray-400 mt-2">Patterns: <span id="behavioralPatterns">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Anomaly Detection</h3>
                                <i data-lucide="zap" class="w-5 h-5 text-yellow-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-yellow-400" id="anomalyScore">--</div>
                            <div class="text-sm text-gray-400 mt-2">Models: <span id="anomalyModels">--</span></div>
                        </div>
                    </div>

                    <!-- Threat Analysis -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Threat Distribution</h3>
                            <canvas id="threatChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Recent Threats</h3>
                            <div class="space-y-3 max-h-80 overflow-y-auto" id="recentThreats">
                                <div class="text-sm text-gray-500">Loading threats...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Incident Response -->
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold mb-4">Active Incidents</h3>
                        <div class="space-y-3" id="activeIncidents">
                            <div class="text-sm text-gray-500">No active incidents</div>
                        </div>
                    </div>
                </div>

                <!-- Network Section -->
                <div id="network-section" class="dashboard-section hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold mb-4">Network Operations Center</h3>
                        <p class="text-gray-400">P2P networking status, peer management, and HyperPulse transport metrics</p>
                    </div>

                    <!-- Network Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Connected Peers</h3>
                                <i data-lucide="users" class="w-5 h-5 text-green-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-green-400" id="connectedPeers">--</div>
                            <div class="text-sm text-gray-400 mt-2">Total: <span id="totalPeers">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Network Latency</h3>
                                <i data-lucide="timer" class="w-5 h-5 text-blue-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-blue-400" id="networkLatency">--ms</div>
                            <div class="text-sm text-gray-400 mt-2">Avg: <span id="avgLatency">--ms</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Data Transfer</h3>
                                <i data-lucide="arrow-up-down" class="w-5 h-5 text-purple-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-purple-400" id="dataTransfer">--MB</div>
                            <div class="text-sm text-gray-400 mt-2">Rate: <span id="transferRate">--MB/s</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">HyperPulse Status</h3>
                                <i data-lucide="zap" class="w-5 h-5 text-orange-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-orange-400" id="hyperpulseStatus">Active</div>
                            <div class="text-sm text-gray-400 mt-2">Streams: <span id="activeStreams">--</span></div>
                        </div>
                    </div>

                    <!-- Network Topology & Peers -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Network Topology</h3>
                            <canvas id="topologyChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Peer List</h3>
                            <div class="space-y-3 max-h-80 overflow-y-auto" id="peerList">
                                <div class="text-sm text-gray-500">Loading peers...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Connection Metrics -->
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold mb-4">Connection Performance</h3>
                        <canvas id="connectionChart"></canvas>
                    </div>
                </div>

                <!-- System Section -->
                <div id="system-section" class="dashboard-section hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold mb-4">System Administration</h3>
                        <p class="text-gray-400">Wolf Pack hierarchy management, prestige system, and Omega controls</p>
                    </div>

                    <!-- System Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Pack Members</h3>
                                <i data-lucide="users" class="w-5 h-5 text-purple-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-purple-400" id="packMembers">--</div>
                            <div class="text-sm text-gray-400 mt-2">Active: <span id="activePack">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Prestige Pool</h3>
                                <i data-lucide="star" class="w-5 h-5 text-yellow-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-yellow-400" id="prestigePool">--</div>
                            <div class="text-sm text-gray-400 mt-2">Decay Rate: <span id="decayRate">--/min</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Omega Status</h3>
                                <i data-lucide="crown" class="w-5 h-5 text-red-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-red-400" id="omegaStatus">Active</div>
                            <div class="text-sm text-gray-400 mt-2">Controls: <span id="omegaControls">--</span></div>
                        </div>
                    </div>

                    <!-- Hierarchy Management -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Pack Hierarchy</h3>
                            <canvas id="hierarchyChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Role Distribution</h3>
                            <canvas id="roleChart"></canvas>
                        </div>
                    </div>

                    <!-- Administrative Controls -->
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold mb-4">Administrative Actions</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="adminControls">
                            <div class="text-sm text-gray-500">Loading controls...</div>
                        </div>
                    </div>
                </div>

                <!-- Intelligence Section -->
                <div id="intelligence-section" class="dashboard-section hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold mb-4">Threat Intelligence</h3>
                        <p class="text-gray-400">CVE feeds, AI threat predictions, and threat indicators</p>
                    </div>

                    <!-- Intelligence Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Critical CVEs</h3>
                                <i data-lucide="alert-circle" class="w-5 h-5 text-red-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-red-400" id="criticalCVEs">--</div>
                            <div class="text-sm text-gray-400 mt-2">This Week: <span id="cveWeek">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">AI Predictions</h3>
                                <i data-lucide="brain" class="w-5 h-5 text-blue-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-blue-400" id="aiPredictions">--</div>
                            <div class="text-sm text-gray-400 mt-2">Accuracy: <span id="predictionAccuracy">--%</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Threat Indicators</h3>
                                <i data-lucide="target" class="w-5 h-5 text-orange-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-orange-400" id="threatIndicators">--</div>
                            <div class="text-sm text-gray-400 mt-2">Active: <span id="activeIndicators">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Intelligence Feeds</h3>
                                <i data-lucide="rss" class="w-5 h-5 text-green-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-green-400" id="intelligenceFeeds">--</div>
                            <div class="text-sm text-gray-400 mt-2">Updated: <span id="lastFeedUpdate">--</span></div>
                        </div>
                    </div>

                    <!-- Intelligence Content -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">CVE Timeline</h3>
                            <canvas id="cveChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Latest CVEs</h3>
                            <div class="space-y-3 max-h-80 overflow-y-auto" id="latestCVEs">
                                <div class="text-sm text-gray-500">Loading CVEs...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Threat Intelligence -->
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold mb-4">Threat Intelligence Dashboard</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="threatIntelContent">
                            <div class="text-sm text-gray-500">Loading intelligence data...</div>
                        </div>
                    </div>
                </div>

                <!-- Compliance Section -->
                <div id="compliance-section" class="dashboard-section hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold mb-4">Compliance & Reporting</h3>
                        <p class="text-gray-400">SOC2/GDPR compliance status, audit trails, and automated reporting</p>
                    </div>

                    <!-- Compliance Status -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">SOC2 Compliance</h3>
                                <i data-lucide="check-circle" class="w-5 h-5 text-green-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-green-400" id="soc2Status">--%</div>
                            <div class="text-sm text-gray-400 mt-2">Last Audit: <span id="lastSOC2Audit">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">GDPR Compliance</h3>
                                <i data-lucide="shield" class="w-5 h-5 text-blue-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-blue-400" id="gdprStatus">--%</div>
                            <div class="text-sm text-gray-400 mt-2">Data Subjects: <span id="dataSubjects">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Audit Trail</h3>
                                <i data-lucide="file-text" class="w-5 h-5 text-purple-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-purple-400" id="auditEntries">--</div>
                            <div class="text-sm text-gray-400 mt-2">Retention: <span id="auditRetention">--days</span></div>
                        </div>
                    </div>

                    <!-- Compliance Reports -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Compliance Score Trend</h3>
                            <canvas id="complianceChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Recent Audits</h3>
                            <div class="space-y-3 max-h-80 overflow-y-auto" id="recentAudits">
                                <div class="text-sm text-gray-500">Loading audits...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Reporting Tools -->
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold mb-4">Automated Reports</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="reportTools">
                            <div class="text-sm text-gray-500">Loading reports...</div>
                        </div>
                    </div>
                </div>

                <!-- Administration Section -->
                <div id="administration-section" class="dashboard-section hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold mb-4">System Administration</h3>
                        <p class="text-gray-400">User management, role assignments, and system configuration</p>
                    </div>

                    <!-- Admin Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Total Users</h3>
                                <i data-lucide="users" class="w-5 h-5 text-blue-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-blue-400" id="totalUsers">--</div>
                            <div class="text-sm text-gray-400 mt-2">Active: <span id="activeUsers">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Role Changes</h3>
                                <i data-lucide="user-check" class="w-5 h-5 text-green-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-green-400" id="roleChanges">--</div>
                            <div class="text-sm text-gray-400 mt-2">This Week: <span id="roleChangesWeek">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">System Health</h3>
                                <i data-lucide="activity" class="w-5 h-5 text-purple-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-purple-400" id="systemHealth">--%</div>
                            <div class="text-sm text-gray-400 mt-2">Uptime: <span id="systemUptime">--</span></div>
                        </div>

                        <div class="metric-card">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">API Requests</h3>
                                <i data-lucide="zap" class="w-5 h-5 text-orange-400"></i>
                            </div>
                            <div class="text-2xl font-bold text-orange-400" id="apiRequests">--</div>
                            <div class="text-sm text-gray-400 mt-2">Rate: <span id="apiRate">--/min</span></div>
                        </div>
                    </div>

                    <!-- User Management -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">User Roles Distribution</h3>
                            <canvas id="userRolesChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Recent User Activity</h3>
                            <div class="space-y-3 max-h-80 overflow-y-auto" id="userActivity">
                                <div class="text-sm text-gray-500">Loading activity...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Administrative Tools -->
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold mb-4">Administrative Tools</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="adminTools">
                            <div class="text-sm text-gray-500">Loading tools...</div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settings-section" class="dashboard-section hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold mb-4">Settings & Configuration</h3>
                        <p class="text-gray-400">AI API integration, firewall rules, zero trust policies, and system preferences</p>
                    </div>

                    <!-- Settings Categories -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">AI Integration</h3>
                            <div class="space-y-4" id="aiSettings">
                                <div class="text-sm text-gray-500">Loading AI settings...</div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Security Policies</h3>
                            <div class="space-y-4" id="securitySettings">
                                <div class="text-sm text-gray-500">Loading security settings...</div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <h3 class="text-lg font-semibold mb-4">Network Configuration</h3>
                            <div class="space-y-4" id="networkSettings">
                                <div class="text-sm text-gray-500">Loading network settings...</div>
                            </div>
                        </div>
                    </div>

                    <!-- System Preferences -->
                    <div class="chart-container">
                        <h3 class="text-lg font-semibold mb-4">System Preferences</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="systemPreferences">
                            <div class="text-sm text-gray-500">Loading preferences...</div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Notification Toast -->
    <div id="notificationToast" class="fixed bottom-6 right-6 notification-toast">
        <div class="bg-gray-800/90 backdrop-blur-sm border border-gray-700 rounded-lg p-4 shadow-lg flex items-center space-x-3">
            <i data-lucide="bell" class="w-5 h-5 text-blue-400"></i>
            <div>
                <p class="font-medium" id="notificationTitle">Notification</p>
                <p class="text-sm text-gray-300" id="notificationMessage">Message</p>
            </div>
            <button onclick="dismissNotification()" class="ml-auto text-gray-400 hover:text-gray-200">
                <i data-lucide="x" class="w-4 h-4"></i>
            </button>
        </div>
    </div>
    
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Global state
        let currentSection = 'overview';
        let socket;
        let apiKey = 'dev-key-12345'; // In production, this would come from secure storage

        // Section management
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.dashboard-section').forEach(section => {
                section.classList.add('hidden');
            });

            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('bg-purple-600/20', 'text-purple-300');
                link.classList.add('hover:bg-gray-700/50');
            });

            // Show selected section
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }

            // Update active nav link
            const activeLink = document.querySelector(`[data-section="${sectionName}"]`);
            if (activeLink) {
                activeLink.classList.add('bg-purple-600/20', 'text-purple-300');
                activeLink.classList.remove('hover:bg-gray-700/50');
            }

            // Update page title
            const titles = {
                'overview': 'Dashboard Overview',
                'security': 'Security Operations Center',
                'network': 'Network Operations Center',
                'system': 'System Administration',
                'intelligence': 'Threat Intelligence',
                'compliance': 'Compliance & Reporting',
                'administration': 'System Administration',
                'settings': 'Settings & Configuration'
            };
            document.getElementById('pageTitle').textContent = titles[sectionName] || 'Dashboard';

            currentSection = sectionName;

            // Load section data
            loadSectionData(sectionName);
        }

        // Load data for specific section
        async function loadSectionData(section) {
            try {
                switch(section) {
                    case 'security':
                        await loadSecurityData();
                        break;
                    case 'network':
                        await loadNetworkData();
                        break;
                    case 'system':
                        await loadSystemData();
                        break;
                    case 'intelligence':
                        await loadIntelligenceData();
                        break;
                    case 'compliance':
                        await loadComplianceData();
                        break;
                    case 'administration':
                        await loadAdministrationData();
                        break;
                    case 'settings':
                        await loadSettingsData();
                        break;
                    default:
                        break;
                }
            } catch (error) {
                console.error(`Failed to load ${section} data:`, error);
            }
        }

        // Connect to WebSocket
        function connectWebSocket() {
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsUrl = `${protocol}//${window.location.host}/api/ws/dashboard?api_key=${apiKey}`;

            socket = new WebSocket(wsUrl);

            socket.onopen = function() {
                console.log('WebSocket connected');
                showNotification('Connected', 'Real-time updates enabled');
                updateConnectionStatus(true);
            };

            socket.onmessage = function(event) {
                const data = JSON.parse(event.data);
                handleWebSocketMessage(data);
            };

            socket.onclose = function() {
                console.log('WebSocket disconnected');
                showNotification('Disconnected', 'Attempting to reconnect...');
                updateConnectionStatus(false);
                setTimeout(connectWebSocket, 5000); // Reconnect after 5 seconds
            };

            socket.onerror = function(error) {
                console.error('WebSocket error:', error);
                showNotification('Error', 'WebSocket connection failed');
            };
        }
        
        // Load data for each section
        async function loadSecurityData() {
            try {
                const [threatsResponse, behavioralResponse, securityResponse] = await Promise.all([
                    fetch('/api/v1/threats/', {
                        headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                    }),
                    fetch('/api/v1/behavioral/', {
                        headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                    }),
                    fetch('/api/v1/security/status', {
                        headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                    })
                ]);

                if (threatsResponse.ok) {
                    const data = await threatsResponse.json();
                    updateSecurityMetrics(data);
                }

                if (behavioralResponse.ok) {
                    const behavioralData = await behavioralResponse.json();
                    updateBehavioralMetrics(behavioralData);
                }

                if (securityResponse.ok) {
                    const securityData = await securityResponse.json();
                    document.getElementById('securityScore').textContent = (securityData.security_score * 100).toFixed(1) + '%';
                }
            } catch (error) {
                console.error('Failed to load security data:', error);
                // Fallback to mock data
                document.getElementById('activeThreatsCount').textContent = '5';
                document.getElementById('threats24h').textContent = '12';
                document.getElementById('behavioralScore').textContent = '0.75';
                document.getElementById('behavioralPatterns').textContent = '23';
                document.getElementById('securityScore').textContent = '85%';
            }
        }

        async function loadNetworkData() {
            try {
                const response = await fetch('/api/v1/network/status', {
                    headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                });
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('connectedPeers').textContent = data.connected_peers;
                    document.getElementById('totalPeers').textContent = data.total_peers;
                    document.getElementById('networkLatency').textContent = data.network_latency.toFixed(1) + 'ms';
                    document.getElementById('avgLatency').textContent = data.average_latency.toFixed(1) + 'ms';
                    document.getElementById('dataTransfer').textContent = (data.data_transfer / 1024).toFixed(1) + 'GB';
                    document.getElementById('transferRate').textContent = data.transfer_rate.toFixed(1) + 'MB/s';
                    document.getElementById('hyperpulseStatus').textContent = data.hyperpulse_status;
                    document.getElementById('activeStreams').textContent = data.active_streams;
                }
            } catch (error) {
                console.error('Failed to load network data:', error);
                // Fallback to mock data
                document.getElementById('connectedPeers').textContent = '12';
                document.getElementById('totalPeers').textContent = '45';
                document.getElementById('networkLatency').textContent = '23ms';
                document.getElementById('avgLatency').textContent = '18ms';
                document.getElementById('dataTransfer').textContent = '2.4GB';
                document.getElementById('transferRate').textContent = '1.2MB/s';
                document.getElementById('hyperpulseStatus').textContent = 'Active';
                document.getElementById('activeStreams').textContent = '8';
            }
        }

        async function loadSystemData() {
            try {
                const response = await fetch('/api/v1/system/status', {
                    headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                });
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('packMembers').textContent = data.pack_members;
                    document.getElementById('activePack').textContent = data.active_pack;
                    document.getElementById('prestigePool').textContent = data.prestige_pool.toLocaleString();
                    document.getElementById('decayRate').textContent = data.decay_rate.toFixed(1) + '/min';
                    document.getElementById('omegaStatus').textContent = data.omega_status;
                    document.getElementById('omegaControls').textContent = data.omega_controls;
                }
            } catch (error) {
                console.error('Failed to load system data:', error);
                // Fallback to mock data
                document.getElementById('packMembers').textContent = '23';
                document.getElementById('activePack').textContent = '18';
                document.getElementById('prestigePool').textContent = '1,247';
                document.getElementById('decayRate').textContent = '1/min';
                document.getElementById('omegaStatus').textContent = 'Active';
                document.getElementById('omegaControls').textContent = '5';
            }
        }

        async function loadIntelligenceData() {
            try {
                const response = await fetch('/api/v1/intelligence/status', {
                    headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                });
                if (response.ok) {
                    const data = await response.json();
                    if (document.getElementById('criticalCVEs')) document.getElementById('criticalCVEs').textContent = data.critical_cves;
                    if (document.getElementById('cveWeek')) document.getElementById('cveWeek').textContent = data.cve_week;
                    if (document.getElementById('aiPredictions')) document.getElementById('aiPredictions').textContent = data.ai_predictions;
                    if (document.getElementById('predictionAccuracy')) document.getElementById('predictionAccuracy').textContent = (data.prediction_accuracy * 100).toFixed(1) + '%';
                    if (document.getElementById('threatIndicators')) document.getElementById('threatIndicators').textContent = data.threat_indicators;
                    if (document.getElementById('activeIndicators')) document.getElementById('activeIndicators').textContent = data.active_indicators;
                    if (document.getElementById('intelligenceFeeds')) document.getElementById('intelligenceFeeds').textContent = data.intelligence_feeds;
                    if (document.getElementById('lastFeedUpdate')) {
                        const date = new Date(data.last_feed_update);
                        document.getElementById('lastFeedUpdate').textContent = date.toLocaleTimeString();
                    }
                }
            } catch (error) {
                console.error('Failed to load intelligence data:', error);
            }
        }

        async function loadComplianceData() {
            try {
                const response = await fetch('/api/v1/compliance/status', {
                    headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                });
                if (response.ok) {
                    const data = await response.json();
                    if (document.getElementById('soc2Status')) document.getElementById('soc2Status').textContent = data.soc2_status.toFixed(1) + '%';
                    if (document.getElementById('lastSOC2Audit')) document.getElementById('lastSOC2Audit').textContent = data.last_soc2_audit;
                    if (document.getElementById('gdprStatus')) document.getElementById('gdprStatus').textContent = data.gdpr_status.toFixed(1) + '%';
                    if (document.getElementById('dataSubjects')) document.getElementById('dataSubjects').textContent = data.data_subjects.toLocaleString();
                    if (document.getElementById('auditEntries')) document.getElementById('auditEntries').textContent = data.audit_entries.toLocaleString();
                    if (document.getElementById('auditRetention')) document.getElementById('auditRetention').textContent = data.audit_retention + 'd';
                }
            } catch (error) {
                console.error('Failed to load compliance data:', error);
            }
        }

        async function loadAdministrationData() {
            try {
                const [authResponse, metricsResponse, healthResponse] = await Promise.all([
                    fetch('/api/v1/auth/status', {
                        headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                    }),
                    fetch('/api/v1/metrics/', {
                        headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                    }),
                    fetch('/api/v1/metrics/detailed', {
                        headers: { 'X-API-Key': apiKey, 'Content-Type': 'application/json' }
                    })
                ]);

                if (authResponse.ok) {
                    const authData = await authResponse.json();
                    if (document.getElementById('totalUsers')) document.getElementById('totalUsers').textContent = authData.total_users;
                    if (document.getElementById('activeUsers')) document.getElementById('activeUsers').textContent = authData.active_sessions;
                }

                if (metricsResponse.ok) {
                    const metricsData = await metricsResponse.json();
                    if (document.getElementById('apiRequests')) document.getElementById('apiRequests').textContent = metricsData.request_count.toLocaleString();
                    if (document.getElementById('apiRate')) document.getElementById('apiRate').textContent = metricsData.avg_response_time.toFixed(1) + 'ms';
                }

                if (healthResponse.ok) {
                    const healthData = await healthResponse.json();
                    if (document.getElementById('systemHealth')) document.getElementById('systemHealth').textContent = '100.0%';
                    if (document.getElementById('systemUptime')) document.getElementById('systemUptime').textContent = formatUptime(healthData.system.uptime);
                }
                
                // Keep role changes as is since they aren't in current metrics APIs
                if (document.getElementById('roleChanges')) document.getElementById('roleChanges').textContent = '0';
                if (document.getElementById('roleChangesWeek')) document.getElementById('roleChangesWeek').textContent = '0';

            } catch (error) {
                console.error('Failed to load administration data:', error);
            }
        }

        async function loadSettingsData() {
            // Load settings data - this would be more complex in real implementation
            const aiSettings = document.getElementById('aiSettings');
            aiSettings.innerHTML = `
                <div class="flex items-center justify-between p-3 bg-gray-800/50 rounded">
                    <div>
                        <h4 class="font-medium">Ollama Integration</h4>
                        <p class="text-sm text-gray-400">Local LLM for threat analysis</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="sr-only peer" checked>
                        <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
                    </label>
                </div>
            `;
        }

        // Update security metrics
        function updateSecurityMetrics(data) {
            document.getElementById('activeThreatsCount').textContent = data.active_threats;
            document.getElementById('threats24h').textContent = data.total_threats;
        }

        // Update behavioral metrics
        function updateBehavioralMetrics(data) {
            document.getElementById('behavioralScore').textContent = data.behavioral_score.toFixed(2);
            document.getElementById('behavioralPatterns').textContent = data.pattern_count;
        }

        // Handle WebSocket messages
        function handleWebSocketMessage(message) {
            console.log('Received message:', message);

            switch(message.type) {
                case 'system_metrics':
                    updateSystemMetrics(message);
                    break;
                case 'network_status':
                    updateNetworkStatus(message);
                    break;
                case 'security_alert':
                    addSecurityAlert(message);
                    break;
                case 'threat_update':
                    addActivityItem('Threat Update', message.threat_type + ': ' + message.count + ' detected');
                    break;
                case 'notification':
                    showNotification(message.title, message.message);
                    break;
                case 'security_metrics':
                    if (currentSection === 'security') {
                        updateSecurityMetrics(message);
                    }
                    break;
                case 'behavioral_metrics':
                    if (currentSection === 'security') {
                        updateBehavioralMetrics(message);
                    }
                    break;
                default:
                    console.warn('Unknown message type:', message.type);
            }
        }
        
        // Update system metrics
        function updateSystemMetrics(data) {
            if (document.getElementById('cpuUsage')) document.getElementById('cpuUsage').textContent = data.cpu.toFixed(1) + '%';
            if (document.getElementById('memoryUsage')) document.getElementById('memoryUsage').textContent = data.memory.toFixed(1) + ' MB';
            if (document.getElementById('uptime')) document.getElementById('uptime').textContent = formatUptime(data.uptime);
            if (document.getElementById('systemUptime')) document.getElementById('systemUptime').textContent = formatUptime(data.uptime);
            
            // Update progress bars
            if (document.getElementById('cpuBar')) document.getElementById('cpuBar').style.width = data.cpu + '%';
            if (document.getElementById('memoryBar')) document.getElementById('memoryBar').style.width = Math.min(data.memory / 10, 100) + '%';
            
            // Update charts
            updatePerformanceChart(data.cpu, data.memory);
        }
        
        // Update network status
        function updateNetworkStatus(data) {
            if (document.getElementById('activePeers')) document.getElementById('activePeers').textContent = data.peers;
            if (document.getElementById('networkHealth')) document.getElementById('networkHealth').textContent = data.health.toFixed(1);
            if (document.getElementById('connections')) document.getElementById('connections').textContent = data.connections;
            if (document.getElementById('connectedPeers')) document.getElementById('connectedPeers').textContent = data.peers;
            
            // Update network chart
            updateNetworkChart(data.peers, data.connections);
        }
        
        // Add security alert
        function addSecurityAlert(alert) {
            const alertsContainer = document.getElementById('securityAlerts');
            const alertElement = document.createElement('div');
            
            const severityColor = alert.severity === 'high' ? 'text-red-400' : 
                                alert.severity === 'medium' ? 'text-orange-400' : 'text-yellow-400';
            
            alertElement.className = 'flex items-start space-x-3 p-2 hover:bg-gray-800/30 rounded';
            alertElement.innerHTML = `
                <div class="w-2 h-2 bg-red-500 rounded-full mt-2"></div>
                <div class="flex-1">
                    <p class="text-sm font-medium ${severityColor}">${alert.severity.toUpperCase()}: ${alert.message}</p>
                    <p class="text-xs text-gray-500">${new Date(alert.timestamp).toLocaleTimeString()}</p>
                </div>
            `;
            
            alertsContainer.insertBefore(alertElement, alertsContainer.firstChild);
            showNotification('Security Alert', alert.message);
        }
        
        // Add activity item
        function addActivityItem(title, message) {
            const feedContainer = document.getElementById('activityFeed');
            const itemElement = document.createElement('div');
            
            itemElement.className = 'flex items-start space-x-3 p-2 hover:bg-gray-800/30 rounded';
            itemElement.innerHTML = `
                <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                <div class="flex-1">
                    <p class="text-sm font-medium">${title}</p>
                    <p class="text-xs text-gray-300">${message}</p>
                    <p class="text-xs text-gray-500">${new Date().toLocaleTimeString()}</p>
                </div>
            `;
            
            feedContainer.insertBefore(itemElement, feedContainer.firstChild);
        }
        
        // Format uptime
        function formatUptime(seconds) {
            const days = Math.floor(seconds / (24 * 3600));
            const hours = Math.floor((seconds % (24 * 3600)) / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            
            if (days > 0) {
                return `${days}d ${hours}h ${minutes}m`;
            } else if (hours > 0) {
                return `${hours}h ${minutes}m`;
            } else {
                return `${minutes}m ${seconds % 60}s`;
            }
        }
        
        // Update connection status
        function updateConnectionStatus(connected) {
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            
            if (!statusDot || !statusText) return;

            if (connected) {
                statusDot.classList.remove('bg-gray-500', 'status-offline');
                statusDot.classList.add('bg-green-500', 'status-online');
                statusText.textContent = 'Real-time';
            } else {
                statusDot.classList.remove('bg-green-500', 'status-online');
                statusDot.classList.add('bg-gray-500', 'status-offline');
                statusText.textContent = 'Disconnected';
            }
        }
        
        // Show notification
        function showNotification(title, message) {
            const toast = document.getElementById('notificationToast');
            document.getElementById('notificationTitle').textContent = title;
            document.getElementById('notificationMessage').textContent = message;
            
            toast.style.display = 'block';
            
            // Auto-dismiss after 5 seconds
            setTimeout(() => {
                toast.style.display = 'none';
            }, 5000);
        }
        
        // Dismiss notification
        function dismissNotification() {
            document.getElementById('notificationToast').style.display = 'none';
        }
        
        // Initialize charts
        let performanceChart, networkChart;
        
        function initCharts() {
            const perfCtx = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(perfCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 10}, (_, i) => i + 1),
                    datasets: [
                        {
                            label: 'CPU Usage (%)',
                            data: Array(10).fill(0),
                            borderColor: 'rgba(139, 92, 246, 1)',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Memory Usage (MB)',
                            data: Array(10).fill(0),
                            borderColor: 'rgba(59, 130, 246, 1)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(71, 85, 105, 0.2)' },
                            ticks: { color: '#94a3b8' }
                        },
                        x: {
                            grid: { color: 'rgba(71, 85, 105, 0.2)' },
                            ticks: { color: '#94a3b8' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#e2e8f0' }
                        }
                    }
                }
            });
            
            const netCtx = document.getElementById('networkChart').getContext('2d');
            networkChart = new Chart(netCtx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: 10}, (_, i) => i + 1),
                    datasets: [
                        {
                            label: 'Active Peers',
                            data: Array(10).fill(0),
                            backgroundColor: 'rgba(16, 185, 129, 0.7)',
                            borderColor: 'rgba(16, 185, 129, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Connections',
                            data: Array(10).fill(0),
                            backgroundColor: 'rgba(59, 130, 246, 0.7)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(71, 85, 105, 0.2)' },
                            ticks: { color: '#94a3b8' }
                        },
                        x: {
                            grid: { color: 'rgba(71, 85, 105, 0.2)' },
                            ticks: { color: '#94a3b8' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#e2e8f0' }
                        }
                    }
                }
            });
        }
        
        // Update performance chart
        function updatePerformanceChart(cpu, memory) {
            if (performanceChart) {
                // Shift data and add new values
                performanceChart.data.labels.push(new Date().toLocaleTimeString());
                performanceChart.data.labels.shift();
                
                performanceChart.data.datasets[0].data.push(cpu);
                performanceChart.data.datasets[0].data.shift();
                
                performanceChart.data.datasets[1].data.push(memory);
                performanceChart.data.datasets[1].data.shift();
                
                performanceChart.update('quiet');
            }
        }
        
        // Update network chart
        function updateNetworkChart(peers, connections) {
            if (networkChart) {
                // Shift data and add new values
                networkChart.data.labels.push(new Date().toLocaleTimeString());
                networkChart.data.labels.shift();
                
                networkChart.data.datasets[0].data.push(peers);
                networkChart.data.datasets[0].data.shift();
                
                networkChart.data.datasets[1].data.push(connections);
                networkChart.data.datasets[1].data.shift();
                
                networkChart.update('quiet');
            }
        }
        
        // Fetch initial data from API
        async function fetchInitialData() {
            try {
                const response = await fetch('/api/v1/metrics/detailed', {
                    headers: {
                        'X-API-Key': apiKey,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    updateSystemMetrics({
                        cpu: data.system.cpu_usage,
                        memory: data.system.memory_usage,
                        uptime: data.system.uptime
                    });
                    
                    // Trigger other loaders
                    loadIntelligenceData();
                    loadComplianceData();
                    loadAdministrationData();
                }
            } catch (error) {
                console.error('Failed to fetch initial data:', error);
                showNotification('Error', 'Failed to load initial data');
            }
        }
        
        // Refresh button handler
        document.getElementById('refreshBtn').addEventListener('click', function() {
            fetchInitialData();
            showNotification('Refreshed', 'Data refreshed successfully');
        });
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            fetchInitialData();
            connectWebSocket();
            showSection('overview'); // Show overview by default

            // Add search functionality
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function(e) {
                performSearch(e.target.value);
            });

            // Add export functionality
            document.getElementById('exportBtn').addEventListener('click', function() {
                exportCurrentSection();
            });
        });

        // Search functionality
        function performSearch(query) {
            if (!query.trim()) return;

            // Simple search implementation - highlight matching text
            const elements = document.querySelectorAll('.chart-container, .metric-card');
            elements.forEach(element => {
                const text = element.textContent.toLowerCase();
                if (text.includes(query.toLowerCase())) {
                    element.style.border = '2px solid #8b5cf6';
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                } else {
                    element.style.border = '';
                }
            });
        }

        // Export functionality
        function exportCurrentSection() {
            const sectionData = {
                section: currentSection,
                timestamp: new Date().toISOString(),
                data: {}
            };

            // Collect current section data
            const sectionElement = document.getElementById(currentSection + '-section');
            const metrics = sectionElement.querySelectorAll('.metric-card');

            metrics.forEach(metric => {
                const title = metric.querySelector('h3').textContent;
                const value = metric.querySelector('.text-2xl').textContent;
                sectionData.data[title] = value;
            });

            // Create and download JSON file
            const blob = new Blob([JSON.stringify(sectionData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${currentSection}_export_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('Export Complete', `Data exported for ${currentSection} section`);
        }
    </script>
</body>
</html>